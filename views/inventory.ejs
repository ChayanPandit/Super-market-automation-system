<% layout('layout/boiler_plate') %>

<script type="text/javascript">
  let x;
  let y;
  
    function fun(event){
      let w=event.target.parentNode.parentNode.children;
      x=w[3];y=w[4];
    }

    function fillValue(x1,x2){
        const val1=document.getElementById(x1).value
        if(val1!==''){
          x.innerHTML=val1;
          document.getElementById(x1).value=''
        }
        const val2=document.getElementById(x2).value
        if(val2!==''){
          y.innerHTML=val2;
          document.getElementById(x2).value=''
        }
    }

    function addItem(ai0,ai1,ai2,ai3,ai4){
      let itemTable = document.getElementById('item_table');
      let row = itemTable.insertRow(-1);
      let c0 = row.insertCell(0);
      let c1 = row.insertCell(1);
      let c2 = row.insertCell(2);
      let c3 = row.insertCell(3);
      let c4 = row.insertCell(4);
      let c5 = row.insertCell(5);

      let id = document.getElementById(ai0);
      let productName = document.getElementById(ai1);
      let description = document.getElementById(ai2);
      let mrp = document.getElementById(ai3);
      let quantity = document.getElementById(ai4);
      
      c0.innerText = id.value;
      c1.innerText = productName.value;
      c2.innerText = description.value;
      c3.innerText = mrp.value;
      c4.innerText = quantity.value;
      
      let button = document.createElement("button");
      button.innerHTML = "Change";
      button.setAttribute('type','button');
      button.setAttribute("class","btn btn-primary");
      button.setAttribute("data-toggle","modal");
      button.setAttribute("data-target","#ex1");
      button.setAttribute("onclick","fun(event)");
      c5.appendChild(button);
      id.value='';productName.value='';description.value='';mrp.value='';quantity.value='';
      
   }
</script>


<div class="text-center">
    <h1>Inventory</h1>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addItem">
      Add Item
    </button>
    <br><br>
    <table class="table table-dark" id="item_table">
        <thead>
          <th>Product Id</th>
          <th>Product name</th>
          <th>Description</th>
          <th>MRP</th>
          <th>Quantity</th>
          <th>Update</th>
        </thead>
          <% details.forEach(function(item,index){ %>
          <tr>
              <td>100</td>
              <td><%= item.item_name %></td>
              <td><%= item.description %></td>
              <td><%= item.unit_price %></td>
              <td><%= item.quantity %></td>
              <td>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ex1" onclick="fun(event)">
                    Change
                </button>
              </td>
          </tr>
          <% }) %>

      </table>

<!-- Update Modal -->
      <div class="modal fade" id="ex1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Make Changes</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
    
              <form  >
                <label class="col-sm-2 col-form-label">MRP</label>
                <input type="text" id="s1" value=""><br>
                <label class="col-sm-2 col-form-label">Quantity</label>
                <input type="text" id="i1" value=""><br>
              </form>
    
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" 
              onclick="fillValue('s1','i1')">Save changes</button>
            </div>
          </div>
        </div>
      </div>

<!-- add item modal -->
      <div class="modal fade" id="addItem" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered mw-100 w-75" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Add Item</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <form action="/add" method="POST">

            <div class="modal-body">
    
                <label class="col-sm-2 col-form-label" for="ai0">Product Id</label>
                <input type="text" id="ai0" value="" name="i" ><br>
                <label class="col-sm-2 col-form-label" for="ai1">Product Name</label>
                <input type="text" id="ai1" value="" name="i1"  ><br>
                <label class="col-sm-2 col-form-label" for="ai2">Description</label>
                <input type="text" id="ai2" value="" name="i2" ><br>
                <label class="col-sm-2 col-form-label" for="ai3">MRP</label>
                <input type="number" id="ai3" value="" name="i3" ><br>
                <label class="col-sm-2 col-form-label" for="ai4">Quantity</label>
                <input type="number" id="ai4" value="" name="i4" ><br>
    
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button submit" class="btn btn-primary" 
              >Add</button>
            </div>
          </form>

          </div>
        </div>
      </div>
</div>
    